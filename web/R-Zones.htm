<!DOCTYPE html>
<html>
  
  <head>
    <title>Watering Zones</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <!-- https://github.com/gitbrent/bootstrap4-toggle -->
    <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.4.0/css/bootstrap4-toggle.min.css" rel="stylesheet">
	
  </head>
  
  <body>
    <div data-role="page" id="zones">
      

		<nav class="navbar navbar-light" style="background-color: #e9e9e9;">
			<button type="button" onclick="window.location.href='./R-index.htm';" class="btn btn-secondary">Back</button>
			<a class="navbar-brand navbar-text" href="R-index.htm">Watering Zones</a>
			<button type="button" onclick="javascript:zoneSubmitForm();" class="btn btn-secondary">Ok</button>
						
		</nav>
		<!-- /header -->
	  
		<div class="container">
		<form id="zForm" action="#">
			<div class="row">
				<div class="col">
					<div data-role="content">
					<div class="card-columns mb-3" >
					  <div id="zonectl"></div>
					</div>
					</div>
				</div>
			</div>
		</form>
		
		<style>
		.general-card.add-new {
			cursor: pointer;
			box-shadow: none;
			text-align: center;
			border: 1px dashed #386fb7;
			transition: .25s;
		}
		</style>
		<div class="row mt-4">
			<div class="col-sm-4">
				<div class="general-card add-new zone-card">
					<div class="body">
						<div class="icon-container" data-toggle="modal" data-target="#exampleModal">
							<i class="fa fa-plus-circle"></i>
							<p>Add Zone</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- Modal -->
		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog" role="document">
			<div class="modal-content">
			  <div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Add Watering Zone</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				  <span aria-hidden="true">&times;</span>
				</button>
			  </div>
			  <div class="modal-body">
				
				<ul class="nav nav-tabs" id="myTab" role="tablist">
				  <li class="nav-item"><a class="nav-link active" id="zone-tab" data-toggle="tab" href="#zone" role="tab" aria-controls="zone" aria-selected="true">Zone Detail</a></li>
				  <li class="nav-item"><a class="nav-link" id="schedule-tab" data-toggle="tab" href="#schedule" role="tab" aria-controls="schedule" aria-selected="false">Schedule</a></li>
				  <li class="nav-item"><a class="nav-link" id="advanced-tab" data-toggle="tab" href="#advanced" role="tab" aria-controls="advanced" aria-selected="false">Advanced</a></li>
				</ul>
				
				<div class="tab-content" id="myTabContent">
				  <div class="tab-pane fade show active" id="zone" role="tabpanel" aria-labelledby="zone-tab">
					
					<form>
					  <div class="form-group">
						<label for="exampleInputEmail1">Zone Name</label>
						<input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
						<small id="emailHelp" class="form-text text-muted">Assign a name for this irrigation zone</small>
					  </div>
					  <div class="form-group">
						<label for="exampleInputPassword1">Zone Number</label>
						<input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
						<small id="emailHelp" class="form-text text-muted">Choose the zone number that this zone is wired to on your Hunter controller</small>
					  </div>
					  <div class="form-group">
						<label for="exampleInputPassword1">Zone Icon</label>
						<small id="emailHelp" class="form-text text-muted">Choose the icon you want to see on the dashboard for this zone</small>
					  </div>
					  <div class="form-group">
						<label for="exampleInputPassword1">Watering Type</label>
					  </div>
					  <div class="form-group">
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="radio" id="inlineCheckbox1" value="option1">
							  <label class="form-check-label" for="inlineCheckbox1">Time Based Schedule</label>
							</div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="radio" id="inlineCheckbox2" value="option2">
							  <label class="form-check-label" for="inlineCheckbox2">None</label>
							</div>
						<small id="emailHelp" class="form-text text-muted">Water at a specified frequency (eg. every 1 week) and adjust schedule based on temperature and rainfall</small>
					  </div>

					</form>
					
				  </div>
				  <div class="tab-pane fade" id="schedule" role="tabpanel" aria-labelledby="schedule-tab">
				  </div>
				  <div class="tab-pane fade" id="advanced" role="tabpanel" aria-labelledby="advanced-tab">
				  </div>
				</div>
				
			  </div>
			  <div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary">Save changes</button>
			  </div>
			  
			  </form>
			  
			</div>
		  </div>
		</div>
		<!-- /Modal -->
		
		</div><!-- /container -->
				


		<footer class="footer">
			<div class="container">
				<div data-role="footer" class="footer-docs" data-theme="a">
				<p>Powered by <a href="https://github.com/rszimm/sprinklers_pi/wiki">Sprinklers Pi</a> <span id="version"></span></p>
				</div>
			</div>
		</footer>

		</div>
    <!-- /page -->
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.4.0/js/bootstrap4-toggle.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
	
		<script language="javascript">
			$('#zones').ready(function () {
			  $.getJSON("json/zones", function (data) {
				for (var i = 0; i < data.zones.length; i++) {
				  addZoneCtl(i + 1, data.zones[i].name, data.zones[i].enabled, data.zones[i].pump);
				}
				$('#zonectl').trigger('create');
				//$('#zonectl').collapsibleset('refresh');
			  });
			});

			function addZoneCtl(j, name, enabled, pump) {
			  var zone_id = String.fromCharCode(97+j);
			  var new_ctl = $('<div class="card mb-3">' +
					'<div class="card-header"><div class="form-group row"><h3 class="font-weight-bold"><label class="col-sm-2 col-form-label"><i class="fas fa-tint text-primary"></i></label><div class="col-sm-10"><input class="form-control-plaintext" name="z' + zone_id + 'name" id="z' + zone_id + 'name" placeholder="" value="' + name + '" type="text" maxlength=19/></div></h3></div>' +
					((enabled == 'on') ? '<h5>Zone ' : '<h5 style="font-style:italic;">Zone ') + j +
					((enabled == 'on') ? '</h5>' : ' (Disabled)</h5>') + 
					'</div>' +
					'<div class="card-body">' +
					'<div class="form-check pl-0">' +
						'<input data-toggle="toggle" data-onstyle="success" id="cb' + zone_id + 'e" name="z' + zone_id + 'e" type="checkbox" ' + ((enabled == 'on') ? 'checked="on"' : '') + '/>' +
						'<label class="form-check-label" for="cb' + zone_id + 'e">Zone Enabled</label>' +
					'</div>' +
					'<div class="form-check pl-0">' +
						'<input data-toggle="toggle" data-onstyle="success" id="cb' + zone_id + 'p" name="z' + zone_id + 'p" type="checkbox" ' + ((pump == 'on') ? 'checked="on"' : '') + '/>' +
						'<label class="form-check-label" for="cb' + zone_id + 'p">Pump</label>' +            
					'</div>' +
						'<div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Watering Type</h4>' +
							'<p class="card-text">Time Based</p>' +
						'</div><br>' +
						'<div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Run Length</h4>' +
							'<p class="card-text">18min</p>' +
						'</div><br>' +
						'<div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Frequency</h4>' +
							'<p class="card-text">Every Program Start Time</p>' +
						'</div><br>' +
						'<div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Cycle & Soak</h4>' +
							'<div class="checkbox"><label>' +
								'<input id="cs" name="cs" type="checkbox" />' +        
							'Enabled</label></div>' +
						'</div>' +
					'</div>' +
					'<div class="card-footer">' +
						'<div class="row"><div class="col align-self-start text-danger"><a class="delete-button on-card"><span class="fa fa-trash"></span></a></div>' +
						'<div class="col align-self-center text-center"><a class="edit-button on-card" data-toggle="modal" data-target="#exampleModal" ><span class="fa fa-edit"></span></a></div>' +
						'<div class="col align-self-end text-right"><a class="info-button on-card"><span class="fa fa-info-circle"></span></a></div></div>' +
					'</div>' +
				'</div>');
			  new_ctl.appendTo('#zonectl');
			}

			function zoneSubmitForm() {
			  $.ajax({
				data: $('#zForm').serialize(),
				type: 'get',
				url: 'bin/setZones',
				success: function (d) {
				  window.history.back();
				},
				error: function (xhr, st, e) {
				  alert(st);
				  window.history.back();
				}
			  });
			}
		</script>
	  
		<script language="javascript">
			$('#myModal').on('shown.bs.modal', function () {
			  $('#myInput').trigger('focus')
			})
		</script>

		<script type='text/javascript'>
			$('#myTab a').on('click', function (e) {
			  e.preventDefault()
			  $(this).tab('show')
			})
		</script>
	  
  </body>

</html>
