<!DOCTYPE html>
<html>
  
  <head>
    <title>Watering Zones</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
	
	<link href="https://file.myfontastic.com/GcmTQwKRXeQDK8qzNJF5fP/icons.css" rel="stylesheet">

    <!-- https://github.com/gitbrent/bootstrap4-toggle -->
    <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.4.0/css/bootstrap4-toggle.min.css" rel="stylesheet">
	
  </head>
  
  <body>
    <div data-role="page" id="zones">
      
		<form id="zForm" action="#">
		<nav class="navbar navbar-light" style="background-color: #e9e9e9;">
			<button type="button" onclick="window.location.href='./R-index.htm';" class="btn btn-secondary">Back</button>
			<a class="navbar-brand navbar-text" href="R-index.htm">Watering Zones</a>
			<button type="button" onclick="javascript:zoneSubmitForm();" class="btn btn-secondary">Ok</button>
						
		</nav>
		<!-- /header -->
	  
		<div class="container mt-3">

			<div class="row">
				<div class="col">
					<div data-role="content">
					<div class="card-columns mb-3" >
					  <div id="zonectl"></div>
					</div>
					</div>
				</div>
			</div>
		</form>
		
		<style>
		.general-card.add-new {
			cursor: pointer;
			box-shadow: none;
			text-align: center;
			border: 1px dashed #386fb7;
			transition: .25s;
		}
		</style>
		<div class="row mt-4">
			<div class="col-sm-4">
				<div class="general-card add-new zone-card">
					<div class="body">
						<div class="icon-container" data-toggle="modal" data-target="#exampleModal">
							<i class="fa fa-plus-circle"></i>
							<p>Add Zone</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- **************************************************************************** -->
		<!-- Modal -->
		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog" role="document">
			<div class="modal-content">
			  <div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Add Watering Zone</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				  <span aria-hidden="true">&times;</span>
				</button>
			  </div>
			  <div class="modal-body">
				
				<ul class="nav nav-tabs" id="myTab" role="tablist">
				  <li class="nav-item"><a class="nav-link active" id="zone-tab" data-toggle="tab" href="#zone" role="tab" aria-controls="zone" aria-selected="true">Zone Detail</a></li>
				  <li class="nav-item"><a class="nav-link" id="schedule-tab" data-toggle="tab" href="#schedule" role="tab" aria-controls="schedule" aria-selected="false">Schedule</a></li>
				  <li class="nav-item"><a class="nav-link" id="advanced-tab" data-toggle="tab" href="#advanced" role="tab" aria-controls="advanced" aria-selected="false">Advanced</a></li>
				  <li class="nav-item"><a class="nav-link" id="soak-tab" data-toggle="tab" href="#soak" role="tab" aria-controls="soak" aria-selected="false">Cycle &amp; Soak</a></li>
				</ul>
				
				<div class="tab-content" id="myTabContent">
					
					<!-- ZONE TAB START -->
					<div class="tab-pane fade show active" id="zone" role="tabpanel" aria-labelledby="zone-tab">
						<form>
						  <div class="form-group">
							<label for="CurrentZoneName">Zone Name</label>
							<input type="email" class="form-control" id="CurrentZoneName" aria-describedby="emailHelp">
							<small id="CurrentZoneNameHelp" class="form-text text-muted">Assign a name for this irrigation zone</small>
						  </div>
						  <div class="form-group">
							<label for="CurrentZoneNumber">Zone Number</label>
							<input type="email" class="form-control" id="CurrentZoneNumber" aria-describedby="emailHelp">
							<small id="CurrentZoneNumberHelp" class="form-text text-muted">Choose the zone number that this zone is wired to on your Hunter controller</small>
						  </div>
						  <div class="form-group">
							<label for="CurrentZoneIcon">Zone Icon</label>
							<small id="emailHelp" class="form-text text-muted">Choose the icon you want to see on the dashboard for this zone</small>
							<i class="fas fa-tint fa-2x text-primary mr-3"></i><i class="fab fa-pagelines fa-2x text-success mr-3"></i><i class="fas fa-leaf fa-2x text-success mr-3"></i><i class="fas fa-carrot fa-2x text-warning mr-3"></i><span class="icon-grass fa-2x text-success mr-3"></span>
						  </div>
						  <div class="form-group">
							<label for="exampleInputPassword1">Watering Type</label>
						  </div>
						  <div class="form-group">
								<div class="form-check">
								  <input type="radio" name="wateringTime" class="form-check-input"  id="Timebased" value="option1">
								  <label class="form-check-label" for="Timebased">Time Based Schedule</label>
								</div>
								<div class="form-check">
								  <input type="radio" name="wateringTime" class="form-check-input"  id="TimebasedNone" value="option2">
								  <label class="form-check-label" for="TimebasedNone">None</label>
								</div>
							<small id="emailHelp" class="form-text text-muted">Water at a specified frequency (eg. every 1 week) and adjust schedule based on temperature and rainfall</small>
						  </div>
						</form>
					</div>
				
					<!-- SCHEDULE TAB START -->
					<div class="tab-pane fade" id="schedule" role="tabpanel" aria-labelledby="schedule-tab">
						<div class="tab-panel">
							<form class="was-validated">
								<div class="content">
									<h6>Watering Type</h6>
									<div class="text-muted sub-title"><span></span></div>
									<div class="form-group">
										<div class="form-check">
											<input type="radio" name="wateringType" class="form-check-input" id="radio-enter-time" value="1">
											<label class="form-check-label" for="radio-enter-time">Enter Time and Frequency below</label>
										</div>
										<div class="form-check">
											<input type="radio" name="wateringType" class="form-check-input" id="radio-use-preconfigured" value="0">
											<label class="form-check-label" for="radio-use-preconfigured">Use a Preconfigured Watering Schedule</label>
										</div>
									</div>
								</div>
								
								<div class="content">
									<h6>Watering Length</h6>
									<div class="text-muted sub-title"><span>The number of minutes this zone will run for each time</span></div>
									<div class="form-group">
										<div class="input-group mb-3">
											<input type="number" class="form-control" placeholder="Enter Watering Length" min="0" value="18" aria-label="Enter Cycle Time" aria-describedby="basic-addon2">
											<div class="input-group-append">
												<span class="input-group-text" id="basic-addon2">minutes</span>
											</div>
										</div>
									</div>
								</div>
								
								<div class="content">
									<h6>Watering Frequency</h6>
									<div class="text-muted sub-title"><span>Choose how often this zone should run</span></div>
									<div class="form-group">
										<div class="form-check">
											<input type="radio" name="wateringFreq" class="form-check-input" id="radio-time-based-zone-category-1" value="1">
											<label class="form-check-label" for="radio-time-based-zone-category-1">Every Program Start Time</label>
										</div>
										<div class="form-check">
											<input type="radio" name="wateringFreq" class="form-check-input" id="radio-time-based-zone-category-0" value="0">
											<label class="form-check-label" for="radio-time-based-zone-category-0">Interval Based Watering</label>
										</div>
									</div>
								</div>
								
								<div class="content">
									<h6>Adaptave Watering</h6>
									<div class="text-muted sub-title"><span>Adjust watering based on the following triggers</span></div>
									
									<div class="watering-trigger-options">
										<div class="form-group">
											<div style="form-check">
												<div class="group-title"><i class="fa fa-power-off m-r-5"></i>Don't water when:</div>
											</div>
											<div style="form-check">
												<input id="wtoption-5" type="checkbox" data-toggle="toggle" data-size="xs" >
												<label for="wtoption-5" class="checkbox-inline ">Forecast below 8Â°C</label>
											</div>
											<div style="form-check">
												<input id="wtoption-9" type="checkbox" data-toggle="toggle" data-size="xs" >
												<label for="wtoption-9" class="checkbox-inline ">80%+ chance of rain</label>
											</div>
											<div style="form-check">
												<input id="wtoption-11" type="checkbox" data-toggle="toggle" data-size="xs" >
												<label for="wtoption-11" class="checkbox-inline ">3mm+ rainfall last day</label>
											</div>
											<div style="form-check">
												<input id="wtoption-12" type="checkbox" data-toggle="toggle" data-size="xs" >
												<label for="wtoption-12" class="checkbox-inline ">10mm+ rainfall last 7 days</label>
											</div>
										</div>
										
										<div class="form-group">
											<div style="form-check">
												<div class="group-title"><i class="fa fa-magic m-r-5"></i>Adjust watering:</div>
											</div>
											<div style="form-check">
												<input id="wtoption-8" type="checkbox" data-toggle="toggle" data-size="xs" >
												<label for="wtoption-8" class="checkbox-inline">Water longer when hot</label>
											</div>
											<div style="form-check">	
												<input id="wtoption-7" type="checkbox" data-toggle="toggle" data-size="xs" >
												<label for="wtoption-7" class="checkbox-inline">Water more often when hot</label>
											</div>
										</div>
									</div>
								</div>
								
							</form>
						</div>
					</div>
					
					<!-- ADVANCED TAB START -->
					<div class="tab-pane fade" id="advanced" role="tabpanel" aria-labelledby="advanced-tab">
						<div>
							<div class="tab-panel">
								<form>
									<div class="form-portion">
										<div class="title">Water Adjustment</div>
										<div class="sub-title"><span>Fine tune your watering if your zone appears to be too dry or wet</span></div>
										<div class="content  watering-adjustment">
											<div class="form-group">
												<div class="slider-with-tooltip m-t-16">
													<input type="range" class="form-control-range" min="0" max="200" step="5" value="100">
													<div class="tooltip right">
														<div class="tooltip-arrow"></div>
														<div class="tooltip-inner">Water for normal watering length</div>
													</div>
												</div>
												<div class="range-unit text-center"><span class="pull-left">Water less</span><span>Normal</span><span class="pull-right">Water more</span></div>
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
					
					<!-- SOAK TAB START -->
					<div class="tab-pane fade" id="soak" role="tabpanel" aria-labelledby="soak-tab">
						<div class="tab-panel">
							<form>
								<div class="form-group">
									<div class="title">Cycle &amp; Soak</div>
									<div class="sub-title"><span>Cycle and soak reduces runoff from each zone by pausing an irrigation cycle</span>
										<div class="custom-popover-container m-l-5 theme-white">
											
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="content  ">
										<div class="form-check">
											<input class="" id="radio-enable-cycle-soak" type="radio" value="0">
											<label class="form-check-label" for="radio-enable-cycle-soak">Do not enable cycle and soak</label>
										</div>
										<div class="form-check">
											<input class="" id="radio-disable-cycle-soak" type="radio" value="1">
											<label class="form-check-label" for="radio-disable-cycle-soak">Enable cycle and soak</label>
										</div>
										<div class="form-check">
										<input data-toggle="toggle" data-size="mini" id="cycle-soak-on" name="ze" type="checkbox" checked="on" />
										<label class="form-check-label" for="cycle-soak-on">Enable cycle and soak</label>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="form-portion">
										<div class="title">Cycle Time</div>
										<div class="sub-title"><span>Enter the maximum time the zone can run for</span></div>
										<div class="content  ">
											<div class="input-group mb-3">
												<input type="text" class="form-control" placeholder="Enter Cycle Time" min="0" value="5" aria-label="Enter Cycle Time" aria-describedby="basic-addon2">
												<div class="input-group-append">
													<span class="input-group-text" id="basic-addon2">minutes</span>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div class="form-portion">
										<div class="title">Soak Time</div>
										<div class="sub-title"><span>Enter the minimum time between zone waterings</span></div>
										<div class="content  ">
											<div class="input-group mb-3">
												<input type="text" class="form-control" placeholder="Enter Soak Time" min="0" value="2" aria-label="Enter Soak Time" aria-describedby="basic-addon2">
												<div class="input-group-append">
													<span class="input-group-text" id="basic-addon2">minutes</span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
				
			  </div>
			  <div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary">Save changes</button>
			  </div>
			  
			  </form>
			  
			</div>
		  </div>
		</div>
		<!-- /Modal -->
		<!-- **************************************************************************** -->
		
		</div><!-- /container -->
				


		<footer class="footer">
			<div class="container">
				<div data-role="footer" class="footer-docs" data-theme="a">
				<p>Powered by <a href="https://github.com/rszimm/sprinklers_pi/wiki">Sprinklers Pi</a> <span id="version"></span></p>
				</div>
			</div>
		</footer>

		</div>
    <!-- /page -->
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.4.0/js/bootstrap4-toggle.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
	
		<script language="javascript">
			$('#zones').ready(function () {
			  $.getJSON("json/zones", function (data) {
				for (var i = 0; i < data.zones.length; i++) {
				  addZoneCtl(i + 1, data.zones[i].name, data.zones[i].enabled, data.zones[i].pump);
				}
				$('#zonectl').trigger('create');
				//$('#zonectl').collapsibleset('refresh');
			  });
			});

			function addZoneCtl(j, name, enabled, pump) {
			  var zone_id = String.fromCharCode(97+j);
			  var new_ctl = $('<div class="card mb-3">' +
					'<div class="card-header py-3 d-flex align-items-center"><i class="fas fa-tint fa-2x text-primary mr-3"></i><i class="fab fa-pagelines fa-2x text-success mr-3"></i>' +
					'<div class="form-group"><h5 class="card-title mb-0"><label for="z' + zone_id + 'name" class="col-form-label">' + j + '. </label><input type="text" class="form-control-plaintext" name="z' + zone_id + 'name" id="z' + zone_id + 'name" placeholder="" value="' + name + '" maxlength=19/></h5>' +
					((enabled == 'on') ? '<h7 class="card-subtitle text-muted">Zone ' : '<h7 style="font-style:italic;">Zone ') + j +
					((enabled == 'on') ? '</h7></div>' : ' (Disabled)</h7></div>') + 
					'</div>' +
					'<div class="card-body">' +
					'<div class="form-check pl-0">' +
						'<input data-toggle="toggle" data-size="mini" id="cb' + zone_id + 'e" name="z' + zone_id + 'e" type="checkbox" ' + ((enabled == 'on') ? 'checked="on"' : '') + '/>' +
						'<label class="form-check-label" for="cb' + zone_id + 'e">&nbsp;Zone Enabled</label>' +
					'</div>' +
					'<div class="form-check pl-0">' +
						'<input data-toggle="toggle" data-size="mini" data-onstyle="success" id="cb' + zone_id + 'p" name="z' + zone_id + 'p" type="checkbox" ' + ((pump == 'on') ? 'checked="on"' : '') + '/>' +
						'<label class="form-check-label" for="cb' + zone_id + 'p">&nbsp;Pump</label>' +            
					'</div>' +
						'<hr class="my-2"><div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Watering Type</h4>' +
							'<p class="card-text">Time Based</p>' +
						'</div>' +
						'<hr class="my-2"><div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Run Length</h4>' +
							'<p class="card-text">18min</p>' +
						'</div>' +
						'<hr class="my-2"><div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Frequency</h4>' +
							'<p class="card-text">Every Program Start Time</p>' +
						'</div>' +
						'<hr class="my-2"><div>' +
							'<h4 class="card-subtitle mb-2 text-muted">Cycle & Soak</h4>' +
							'<input data-toggle="toggle" data-size="mini" id="cs" name="cs" type="checkbox" />' +        
							'<label class="form-check-label" for="cs">&nbsp;Enabled</label>' +
						'</div>' +
					'</div>' +
					'<div class="card-footer">' +
						'<div class="row"><div class="col align-self-start text-danger"><a class="delete-button on-card"><span class="fa fa-trash"></span></a></div>' +
						'<div class="col align-self-center text-center"><a class="edit-button on-card" data-toggle="modal" data-target="#exampleModal" ><span class="fa fa-edit"></span></a></div>' +
						'<div class="col align-self-end text-right"><a class="info-button on-card"><span class="fa fa-info-circle"></span></a></div></div>' +
					'</div>' +
				'</div>');
			  new_ctl.appendTo('#zonectl');
			  $('input:checkbox').bootstrapToggle();
			}

			function zoneSubmitForm() {
			  $.ajax({
				data: $('#zForm').serialize(),
				type: 'get',
				url: 'bin/setZones',
				success: function (d) {
				  window.history.back();
				},
				error: function (xhr, st, e) {
				  alert(st);
				  window.history.back();
				}
			  });
			}
		</script>
	  
		<script language="javascript">
			$('#myModal').on('shown.bs.modal', function () {
			  $('#myInput').trigger('focus')
			})
		</script>

		<script type='text/javascript'>
			$('#myTab a').on('click', function (e) {
			  e.preventDefault()
			  $(this).tab('show')
			})
		</script>
	  
  </body>

</html>
